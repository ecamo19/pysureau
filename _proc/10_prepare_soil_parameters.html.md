---
description: 'AUTHORS: __Julien Ruffault (julien.ruff@gmail.com), Nicolas Martin-StPaul
  (nicolas.martin@inrae.fr)__'
output-file: prepare_soil_parameters.html
title: prepare_soil_parameters

---


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

::: {#3e1cafea .cell quarto-private-1='{"key":"vscode","value":{"languageId":"python"}}'}
``` {.python .cell-code}
def prepare_soil_parameters(
    file_path: Path = None,  # Path to the file created with the `soil_parameter_file` function
) -> Dict:  # Dictionary containing soil parameters parameters
    "Create a Dictionary with soil parameters to run SureauR"

    # Read soil parameter CSV file ----------------------------------------------

    soil_parameters_dict = read_soil_file(file_path, sep=',')

    # Reshape parameters --------------------------------------------------------

    # Create single array with Layer thickness
    soil_parameters_dict['soil_layers_thickness'] = collections.defaultdict(
        list,
        {
            'layer_1': soil_parameters_dict['soil_depth_1'],
            'layer_2': soil_parameters_dict['soil_depth_2']
            - soil_parameters_dict['soil_depth_1'],
            'layer_3': soil_parameters_dict['soil_depth_3']
            - soil_parameters_dict['soil_depth_2'],
        },
    )

    soil_parameters_dict['rfc'] = collections.defaultdict(
        list,
        {
            'layer_1': soil_parameters_dict['rfc_1'],
            'layer_2': soil_parameters_dict['rfc_2'],
            'layer_3': soil_parameters_dict['rfc_3'],
        },
    )
    
    # Remove kye-value pairs
    soil_parameters_dict.pop('rfc_1', None)
    soil_parameters_dict.pop('rfc_2', None)
    soil_parameters_dict.pop('rfc_3', None)
    
    
    soil_parameters_dict['soil_depth'] = collections.defaultdict(
        list,
        {
            'layer_1': soil_parameters_dict['soil_depth_1'],
            'layer_2': soil_parameters_dict['soil_depth_2'],
            'layer_3': soil_parameters_dict['soil_depth_3'],
        },
    )
    
    # Remove kye-value pairs
    soil_parameters_dict.pop('soil_depth_1', None)
    soil_parameters_dict.pop('soil_depth_2', None)
    soil_parameters_dict.pop('soil_depth_3', None)

    # Add new soil params for van genuchten formulation -------------------------
    
    if soil_parameters_dict['pedo_transfer_formulation'] == 'vg':
        # Shape parameters of the relationship between soil water content and
        # soil water potential

        # Shape parameter 1
        soil_parameters_dict['alpha_vg'] = collections.defaultdict(
            list,
            {
                'layer_1': soil_parameters_dict['alpha_vg'],
                'layer_2': soil_parameters_dict['alpha_vg'],
                'layer_3': soil_parameters_dict['alpha_vg'],
            },
        )

        # Shape parameter 2

        soil_parameters_dict['n_vg'] = collections.defaultdict(
            list,
            {
                'layer_1': soil_parameters_dict['n_vg'],
                'layer_2': soil_parameters_dict['n_vg'],
                'layer_3': soil_parameters_dict['n_vg'],
            },
        )

        # Shape parameter 3

        soil_parameters_dict['i_vg'] = collections.defaultdict(
            list,
            {
                'layer_1': soil_parameters_dict['i_vg'],
                'layer_2': soil_parameters_dict['i_vg'],
                'layer_3': soil_parameters_dict['i_vg'],
            },
        )

        # Soil conductivity at saturation (mol/m/s/Mpa)
        soil_parameters_dict['ksat_vg'] = collections.defaultdict(
            list,
            {
                'layer_1': soil_parameters_dict['ksat_vg'],
                'layer_2': soil_parameters_dict['ksat_vg'],
                'layer_3': soil_parameters_dict['ksat_vg'],
            },
        )
        # Fraction of water at saturation capacity (cm3/cm3)
        soil_parameters_dict['saturation_capacity_vg'] = collections.defaultdict(
            list,
            {
                'layer_1': soil_parameters_dict['saturation_capacity_vg'],
                'layer_2': soil_parameters_dict['saturation_capacity_vg'],
                'layer_3': soil_parameters_dict['saturation_capacity_vg'],
            },
        )

        # Fraction of residual water (cm3/cm3)
        soil_parameters_dict['residual_capacity_vg'] = collections.defaultdict(
            list,
            {
                'layer_1': soil_parameters_dict['residual_capacity_vg'],
                'layer_2': soil_parameters_dict['residual_capacity_vg'],
                'layer_3': soil_parameters_dict['residual_capacity_vg'],
            },
        )

        # Add computation of wilting point
        soil_parameters_dict['wilting_point'] = collections.defaultdict(
            list,
            {
                'layer_1': compute_theta_at_given_p_soil(
                    psi_target=1.5,
                    theta_res=soil_parameters_dict['residual_capacity_vg'][
                        'layer_1'
                    ],
                    theta_sat=soil_parameters_dict['saturation_capacity_vg'][
                        'layer_1'
                    ],
                    alpha_vg=soil_parameters_dict['alpha_vg']['layer_1'],
                    n_vg=soil_parameters_dict['n_vg']['layer_1'],
                ),
                'layer_2': compute_theta_at_given_p_soil(
                    psi_target=1.5,
                    theta_res=soil_parameters_dict['residual_capacity_vg'][
                        'layer_2'
                    ],
                    theta_sat=soil_parameters_dict['saturation_capacity_vg'][
                        'layer_2'
                    ],
                    alpha_vg=soil_parameters_dict['alpha_vg']['layer_2'],
                    n_vg=soil_parameters_dict['n_vg']['layer_2'],
                ),
                'layer_3': compute_theta_at_given_p_soil(
                    psi_target=1.5,
                    theta_res=soil_parameters_dict['residual_capacity_vg'][
                        'layer_2'
                    ],
                    theta_sat=soil_parameters_dict['saturation_capacity_vg'][
                        'layer_2'
                    ],
                    alpha_vg=soil_parameters_dict['alpha_vg']['layer_2'],
                    n_vg=soil_parameters_dict['n_vg']['layer_2'],
                ),
            },
        )

        # Add computation of field capacity from functions
        soil_parameters_dict['field_capacity'] = collections.defaultdict(
            list,
            {
                'layer_1': compute_theta_at_given_p_soil(
                    psi_target=soil_parameters_dict['psoil_at_field_capacity'],
                    theta_res=soil_parameters_dict['residual_capacity_vg'][
                        'layer_1'
                    ],
                    theta_sat=soil_parameters_dict['saturation_capacity_vg'][
                        'layer_1'
                    ],
                    alpha_vg=soil_parameters_dict['alpha_vg']['layer_1'],
                    n_vg=soil_parameters_dict['n_vg']['layer_1'],
                ),
                'layer_2': compute_theta_at_given_p_soil(
                    psi_target=soil_parameters_dict['psoil_at_field_capacity'],
                    theta_res=soil_parameters_dict['residual_capacity_vg'][
                        'layer_2'
                    ],
                    theta_sat=soil_parameters_dict['saturation_capacity_vg'][
                        'layer_2'
                    ],
                    alpha_vg=soil_parameters_dict['alpha_vg']['layer_2'],
                    n_vg=soil_parameters_dict['n_vg']['layer_2'],
                ),
                'layer_3': compute_theta_at_given_p_soil(
                    psi_target=soil_parameters_dict['psoil_at_field_capacity'],
                    theta_res=soil_parameters_dict['residual_capacity_vg'][
                        'layer_3'
                    ],
                    theta_sat=soil_parameters_dict['saturation_capacity_vg'][
                        'layer_3'
                    ],
                    alpha_vg=soil_parameters_dict['alpha_vg']['layer_3'],
                    n_vg=soil_parameters_dict['n_vg']['layer_3'],
                ),
            },
        )
        
        # v_ parameters ---------------------------------------------------------
        soil_parameters_dict['v_field_capacity_vg'] = (
                collections.defaultdict(
                    list,
                    {'layer_1':convert_f_to_v(x=soil_parameters_dict['field_capacity']['layer_1'],
                                                     rfc=soil_parameters_dict['rfc']['layer_1'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_1'],),
                     
                    'layer_2':convert_f_to_v(x=soil_parameters_dict['field_capacity']['layer_2'],
                                                     rfc=soil_parameters_dict['rfc']['layer_2'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_2'],),
                    
                    'layer_3':convert_f_to_v(x=soil_parameters_dict['field_capacity']['layer_3'],
                                                     rfc=soil_parameters_dict['rfc']['layer_3'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_3'],),
                    }
                )
            )
        
        soil_parameters_dict['v_field_capacity_vg'] = (
                collections.defaultdict(
                    list,
                    {'layer_1':convert_f_to_v(x=soil_parameters_dict['saturation_capacity_vg']['layer_1'],
                                                     rfc=soil_parameters_dict['rfc']['layer_1'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_1'],),
                     
                    'layer_2':convert_f_to_v(x=soil_parameters_dict['saturation_capacity_vg']['layer_2'],
                                                     rfc=soil_parameters_dict['rfc']['layer_2'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_2'],),
                    
                    'layer_3':convert_f_to_v(x=soil_parameters_dict['saturation_capacity_vg']['layer_3'],
                                                     rfc=soil_parameters_dict['rfc']['layer_3'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_3'],),
                    }
                )
            )
    
        soil_parameters_dict['v_residual_capacity_vg'] = (
                collections.defaultdict(
                    list,
                    {'layer_1':convert_f_to_v(x=soil_parameters_dict['residual_capacity_vg']['layer_1'],
                                                     rfc=soil_parameters_dict['rfc']['layer_1'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_1'],),
                     
                    'layer_2':convert_f_to_v(x=soil_parameters_dict['residual_capacity_vg']['layer_2'],
                                                     rfc=soil_parameters_dict['rfc']['layer_2'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_2'],),
                    
                    'layer_3':convert_f_to_v(x=soil_parameters_dict['residual_capacity_vg']['layer_3'],
                                                     rfc=soil_parameters_dict['rfc']['layer_3'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_3'],),
                    }
                )
            )

    
    
        # Add v_wilting_point
        soil_parameters_dict['v_wilting_point'] = (
                collections.defaultdict(
                    list,
                    {'layer_1':convert_f_to_v(x=soil_parameters_dict['wilting_point']['layer_1'],
                                                     rfc=soil_parameters_dict['rfc']['layer_1'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_1'],),
                     
                    'layer_2':convert_f_to_v(x=soil_parameters_dict['wilting_point']['layer_2'],
                                                     rfc=soil_parameters_dict['rfc']['layer_2'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_2'],),
                    
                    'layer_3':convert_f_to_v(x=soil_parameters_dict['wilting_point']['layer_3'],
                                                     rfc=soil_parameters_dict['rfc']['layer_3'],
                                                     layer_thickness=soil_parameters_dict['soil_layers_thickness']['layer_3'],),
                    }
                )
            )
    #            # For diagnostic, Unknown reason why
    #            soil_parameters_dict['v_soil_storage_capacity_wilt'] = np.sum(soil_parameters_dict['v_field_capacity']) - np.sum(soil_parameters_dict['v_wilting_point'])
    #            soil_parameters_dict['v_soil_storage_capacity_res'] = np.sum(soil_parameters_dict['v_field_capacity']) - np.sum(soil_parameters_dict['v_residual_capacity_vg'])
    #            soil_parameters_dict['v_soil_storage_capacity'] = soil_parameters_dict['v_soil_storage_capacity_wilt']
    #
    #            print(
    #                f'Available water capacity Wilting: {soil_parameters_dict["v_soil_storage_capacity_wilt"]} mm'
    #            )
    #            print(
    #                f'Available water capacity Residual: {soil_parameters_dict["v_soil_storage_capacity_res"]} mm'
    #            )
    #
    #            print('Can soil_params["v_soil_storage_capacity"] be negative?? Ask')
    #
    
    # Add new soil params for campbell formulation ------------------------------
    elif soil_parameters_dict['pedo_transfer_formulation'] == "campbell":
        
    
                # Shape parameters of the relationship between soil water content and
                # soil water potential
    
                soil_parameters_dict['b_campbell'] = collections.defaultdict(list,{
                        'layer_1': soil_parameters_dict['b_campbell'],
                        'layer_2': soil_parameters_dict['b_campbell'],
                        'layer_3': soil_parameters_dict['b_campbell'],},)

    
                # Shape parameter 2
                soil_parameters_dict['psie'] = collections.defaultdict(list,{
                        'layer_1': soil_parameters_dict['psie'],
                        'layer_2': soil_parameters_dict['psie'],
                        'layer_3': soil_parameters_dict['psie'],},)

                # Soil conductivity at saturation (mol/m/s/Mpa)
                # Value not repeated 3 times as the ksat_vg param
                soil_parameters_dict['ksat_campbell'] = soil_parameters_dict['ksat_campbell']
    
    
                # Fraction of water at saturation capacity (cm3/cm3)                
                soil_parameters_dict['saturation_capacity_campbell'] = collections.defaultdict(list,{
                        'layer_1': soil_parameters_dict['saturation_capacity_campbell'],
                        'layer_2': soil_parameters_dict['saturation_capacity_campbell'],
                        'layer_3': soil_parameters_dict['saturation_capacity_campbell'],},)
                    
                # Add wilting point ---------------------------------------------
                
                soil_parameters_dict['wilting_point'] = collections.defaultdict(
                    list,{
                        'layer_1': compute_theta_at_given_p_soil_camp(psi_target=-5,
                                                                      theta_sat=soil_parameters_dict['saturation_capacity_campbell']['layer_1'],
                                                                      psie=soil_parameters_dict['psie']['layer_1'],
                                                                      b_camp=soil_parameters_dict['b_campbell']['layer_1'],),
                          
                          'layer_2': compute_theta_at_given_p_soil_camp(psi_target=-5,
                                                                        theta_sat=soil_parameters_dict['layer_2']['saturation_capacity_campbell'],
                                                                        psie=soil_parameters_dict['layer_2']['psie'],
                                                                        b_camp=soil_parameters_dict['layer_2']['b_campbell'],),
                          
                          'layer_3': compute_theta_at_given_p_soil_camp(psi_target=-5,
                                                                        theta_sat=soil_parameters_dict['layer_3']['saturation_capacity_campbell'],
                                                                        psie=soil_parameters_dict['layer_3']['psie'],
                                                                        b_camp=soil_parameters_dict['layer_3']['b_campbell'],)},)
    
                # Add field capacity --------------------------------------------
                #soil_parameters_dict['field_capacity'] = collections.defaultdict(
                #    list,{
                #        'layer_1': compute_theta_at_given_p_soil_camp(psi_target=soil_parameters_dict['layer_1']['psoil_at_field_capacity'],
                #                                              theta_sat=soil_parameters_dict['layer_1']['saturation_capacity_campbell'],
                #                                              psie=soil_parameters_dict['layer_1']['psie'],
                #                                              b_camp=soil_parameters_dict['layer_1']['b_campbell']),
                #
                #        'layer_2': compute_theta_at_given_p_soil_camp(psi_target=soil_parameters_dict['layer_2']['psoil_at_field_capacity'],
                #                           theta_sat=soil_parameters_dict['layer_2']['saturation_capacity_campbell'],
                #                           psie=soil_parameters_dict['layer_2']['psie'],
                #                           b_camp=soil_parameters_dict['layer_2']['b_campbell']),
                #                   
                #        'layer_3':compute_theta_at_given_p_soil_camp(psi_target=soil_parameters_dict['layer_3']['psoil_at_field_capacity'],
                #                           theta_sat=soil_parameters_dict['layer_3']['saturation_capacity_campbell'],
                #                           psie=soil_parameters_dict['layer_3']['psie'],
                #                           b_camp=soil_parameters_dict['layer_3']['b_campbell'])})
                #
                # Add residual capacity camp,Fraction of residual water ---------
                # (cm3/cm3)
                #soil_parameters_dict['residual_capacity_campbell'] = collections.defaultdict(
                #    list,{'layer_1': compute_theta_at_given_p_soil_camp(psi_target=-100,
                #                                                        theta_sat=soil_parameters_dict['layer_1']['saturation_capacity_campbell'],
                #                                                        psie=soil_parameters_dict['layer_1']['psie'],
                #                                                        b_camp=soil_parameters_dict['layer_1']['b_campbell'],),
                #          
                #          'layer_2': compute_theta_at_given_p_soil_camp(psi_target=-100,
                #                                                      theta_sat=soil_parameters_dict['layer_2']['saturation_capacity_campbell'],
                #                                                      psie=soil_parameters_dict['layer_2']['psie'],
                #                                                      b_camp=soil_parameters_dict['layer_2']['b_campbell'],),          
                #          
                #          'layer_3': compute_theta_at_given_p_soil_camp(psi_target=-100,
                #                                                        theta_sat=soil_parameters_dict['layer_3']['saturation_capacity_campbell'],
                #                                                        psie=soil_parameters_dict['layer_3']['psie'],
                #                                                        b_camp=soil_parameters_dict['layer_3']['b_campbell'],)})
                #
                # Water values v_parameters -------------------------------------
    
                # Add v_field_capacity
                #soil_parameters_dict['v_field_capacity'] = collections.defaultdict(
                #    list,{'layer_1': convert_f_to_v(x=soil_parameters_dict['layer_1']['field_capacity'],
                #                                    rfc=soil_parameters_dict['layer_1']['rfc'],
                #                                    layer_thickness=soil_parameters_dict['layer_1']['soil_layers_thickness'],),
                #
                #          'layer_2': convert_f_to_v(x=soil_parameters_dict['layer_2']['field_capacity'],
                #                                    rfc=soil_parameters_dict['layer_2']['rfc'],
                #                                    layer_thickness=soil_parameters_dict['layer_2']['soil_layers_thickness'],),
                #         
                #          'layer_3': convert_f_to_v(x=soil_parameters_dict['layer_3']['field_capacity'],
                #                                    rfc=soil_parameters_dict['layer_3']['rfc'],
                #                                    layer_thickness=soil_parameters_dict['layer_3']['soil_layers_thickness'],)
                #            })
                #
                # Add v_saturation_capacity_campbellsoil_params_from_args['n_vg']
                #soil_parameters_dict['v_saturation_capacity_campbell'] = collections.defaultdict(
                #    list,{'layer_1':  convert_f_to_v(x=soil_parameters_dict['layer_1']['saturation_capacity_campbell'],
                #                                     rfc=soil_parameters_dict['layer_1']['rfc'],
                #                                     layer_thickness=soil_parameters_dict['layer_']['soil_layers_thickness'],),
                #          
                #          'layer_2':  convert_f_to_v(x=soil_parameters_dict['layer_1']['saturation_capacity_campbell'],
                #                                     rfc=soil_parameters_dict['layer_1']['rfc'],
                #                                     layer_thickness=soil_parameters_dict['layer_']['soil_layers_thickness'],),
                #          
                #          'layer_3':  convert_f_to_v(x=soil_parameters_dict['layer_1']['saturation_capacity_campbell'],
                #                                     rfc=soil_parameters_dict['layer_1']['rfc'],
                #                                     layer_thickness=soil_parameters_dict['layer_1']['soil_layers_thickness'],)})
    
                # Add v_residual_capacity_campbell
                #soil_parameters_dict['v_residual_capacity_campbell'] = collections.defaultdict(
                #    list,{'layer_1': convert_f_to_v(x=soil_parameters_dict['layer_1']['residual_capacity_campbell'],
                #                                    rfc=soil_parameters_dict['layer_1']['rfc'],
                #                                    layer_thickness=soil_parameters_dict['layer_1']['soil_layers_thickness'],),
                #          
                #          'layer_2': convert_f_to_v(x=soil_parameters_dict['layer_2']['residual_capacity_campbell'],
                #                                    rfc=soil_parameters_dict['layer_2']['rfc'],
                #                                    layer_thickness=soil_parameters_dict['layer_2']['soil_layers_thickness'],), 
                #          
                #          'layer_3': convert_f_to_v(x=soil_parameters_dict['layer_3']['residual_capacity_campbell'],
                #                                    rfc=soil_parameters_dict['layer_3']['rfc'],
                #                                    layer_thickness=soil_parameters_dict['layer_3']['soil_layers_thickness'],)})
    
                # Add v_wilting_point
                
                #soil_parameters_dict['v_wilting_point'] = collections.defaultdict(
                #    list,{'layer_1': convert_f_to_v(x=soil_parameters_dict['1']['wilting_point'],
                #                                    rfc=soil_parameters_dict['1']['rfc'],
                #                                    layer_thickness=soil_parameters_dict['1']['layer_thickness'],),
                #          
                #          'layer_2': convert_f_to_v(x=soil_parameters_dict['2']['wilting_point'],
                #                                    rfc=soil_parameters_dict['2']['rfc'],
                #                                    layer_thickness=soil_parameters_dict['2']['layer_thickness'],),
                #          
                #          'layer_3': convert_f_to_v(x=soil_parameters_dict['3']['wilting_point'],
                #                                    rfc=soil_parameters_dict['3']['rfc'],
                #                                    layer_thickness=soil_parameters_dict['3']['layer_thickness'],)})
    
                # Duplicate v_saturation_capacity, Don't know why
                #soil_parameters_dict['v_saturation_capacity'] = soil_parameters_dict['v_saturation_capacity_campbell']
    
                # For diagnostic (TAW)
                #soil_parameters_dict['v_soil_storage_capacity_wilt_campbell'] = np.sum(soil_parameters_dict['v_field_capacity']) - np.sum(soil_parameters_dict['v_wilting_point'])
    
                #soil_parameters_dict['v_soil_storage_capacity_res_campbell'] = np.sum(soil_parameters_dict['v_field_capacity']) - np.sum(soil_parameters_dict['v_residual_capacity_campbell'])
    
                #soil_parameters_dict['v_soil_storage_capacity'] = soil_parameters_dict['v_soil_storage_capacity_wilt_campbell']
    
                #print(
                #    f'Available water capacity Wilting: {soil_parameters_dict["v_soil_storage_capacity_wilt_campbell"]} mm'
                #)
                
                #print(
                #    f'Available water capacity Residual: {soil_parameters_dict["v_soil_storage_capacity_res_campbell"]} mm'
                #)
    
                #print('Can soil_params["v_soil_storage_capacity"] be negative?? Ask')
    
    else:
                # f'Option {soil_parameters_dict["pedo_transfer_formulation"]} not recognized.'
                raise ValueError("Failed to create soil parameters from input file")
    
    return soil_parameters_dict
```
:::


#### __Example: Create soil parameters__

::: {#7e22dbdd .cell quarto-private-1='{"key":"vscode","value":{"languageId":"python"}}'}
``` {.python .cell-code}
from pysureau.pysureau_init import pysureau_init
```
:::


::: {#6137da2f .cell quarto-private-1='{"key":"vscode","value":{"languageId":"python"}}'}
``` {.python .cell-code}
#pysureau_init('/tmp')
```

::: {.cell-output .cell-output-stdout}
```
CSV parameter file saved at /tmp/pysureau_project_he3V99rs/1_parameter_files/soil_parameters_vg.csv
CSV parameter file saved at /tmp/pysureau_project_he3V99rs/1_parameter_files/soil_parameters_campbell.csv
CSV parameter file saved at /tmp/pysureau_project_he3V99rs/1_parameter_files/modeling_options.csv
CSV parameter file saved at /tmp/pysureau_project_he3V99rs/1_parameter_files/vegetation_parameters.csv
pysureau project created at /tmp/pysureau_project_he3V99rs
```
:::
:::


::: {#62cf0f49 .cell quarto-private-1='{"key":"vscode","value":{"languageId":"python"}}'}
``` {.python .cell-code}
#prepare_soil_parameters(file_path='/tmp/pysureau_project_he3V99rs/1_parameter_files/soil_parameters_campbell.csv',)
```

::: {.cell-output .cell-output-error}

::: {.ansi-escaped-output}
```{=html}
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[23]</span><span class="ansi-green-fg">, line 1</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">1</span> <span class="ansi-yellow-bg">prepare_soil_parameters</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">file_path</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-fg ansi-yellow-bg">/tmp/pysureau_project_he3V99rs/1_parameter_files/soil_parameters_campbell.csv</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[22]</span><span class="ansi-green-fg">, line 324</span>, in <span class="ansi-cyan-fg">prepare_soil_parameters</span><span class="ansi-blue-fg">(file_path)</span>
<span class="ansi-green-fg">    315</span>             soil_parameters_dict[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">saturation_capacity_campbell</span><span class="ansi-yellow-fg">'</span>] = collections.defaultdict(<span style="color:rgb(0,135,0)">list</span>,{
<span class="ansi-green-fg">    316</span>                     <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_1</span><span class="ansi-yellow-fg">'</span>: soil_parameters_dict[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">saturation_capacity_campbell</span><span class="ansi-yellow-fg">'</span>],
<span class="ansi-green-fg">    317</span>                     <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_2</span><span class="ansi-yellow-fg">'</span>: soil_parameters_dict[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">saturation_capacity_campbell</span><span class="ansi-yellow-fg">'</span>],
<span class="ansi-green-fg">    318</span>                     <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_3</span><span class="ansi-yellow-fg">'</span>: soil_parameters_dict[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">saturation_capacity_campbell</span><span class="ansi-yellow-fg">'</span>],},)
<span class="ansi-green-fg">    320</span>             <span style="font-style:italic;color:rgb(95,135,135)"># Add wilting point ---------------------------------------------</span>
<span class="ansi-green-fg">    322</span>             soil_parameters_dict[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">wilting_point</span><span class="ansi-yellow-fg">'</span>] = collections.defaultdict(
<span class="ansi-green-fg">    323</span>                 <span style="color:rgb(0,135,0)">list</span>,{
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">324</span>                     <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_1</span><span class="ansi-yellow-fg">'</span>: <span class="ansi-yellow-bg">compute_theta_at_given_p_soil_camp</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">psi_target</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">-</span><span class="ansi-green-fg ansi-yellow-bg">5</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    325</span> <span class="ansi-yellow-bg">                                                                  </span><span class="ansi-yellow-bg">theta_sat</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">soil_parameters_dict</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-fg ansi-yellow-bg">saturation_capacity_campbell</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-fg ansi-yellow-bg">layer_1</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    326</span> <span class="ansi-yellow-bg">                                                                  </span><span class="ansi-yellow-bg">psie</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">soil_parameters_dict</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-fg ansi-yellow-bg">psie</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-fg ansi-yellow-bg">layer_1</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    327</span> <span class="ansi-yellow-bg">                                                                  </span><span class="ansi-yellow-bg">b_camp</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">soil_parameters_dict</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-fg ansi-yellow-bg">b_campbell</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-fg ansi-yellow-bg">layer_1</span><span class="ansi-yellow-fg ansi-yellow-bg">'</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg">)</span>,
<span class="ansi-green-fg">    328</span> 
<span class="ansi-green-fg">    329</span>                       <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_2</span><span class="ansi-yellow-fg">'</span>: compute_theta_at_given_p_soil_camp(psi_target=-<span class="ansi-green-fg">5</span>,
<span class="ansi-green-fg">    330</span>                                                                     theta_sat=soil_parameters_dict[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_2</span><span class="ansi-yellow-fg">'</span>][<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">saturation_capacity_campbell</span><span class="ansi-yellow-fg">'</span>],
<span class="ansi-green-fg">    331</span>                                                                     psie=soil_parameters_dict[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_2</span><span class="ansi-yellow-fg">'</span>][<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">psie</span><span class="ansi-yellow-fg">'</span>],
<span class="ansi-green-fg">    332</span>                                                                     b_camp=soil_parameters_dict[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_2</span><span class="ansi-yellow-fg">'</span>][<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">b_campbell</span><span class="ansi-yellow-fg">'</span>],),
<span class="ansi-green-fg">    333</span> 
<span class="ansi-green-fg">    334</span>                       <span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_3</span><span class="ansi-yellow-fg">'</span>: compute_theta_at_given_p_soil_camp(psi_target=-<span class="ansi-green-fg">5</span>,
<span class="ansi-green-fg">    335</span>                                                                     theta_sat=soil_parameters_dict[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_3</span><span class="ansi-yellow-fg">'</span>][<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">saturation_capacity_campbell</span><span class="ansi-yellow-fg">'</span>],
<span class="ansi-green-fg">    336</span>                                                                     psie=soil_parameters_dict[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_3</span><span class="ansi-yellow-fg">'</span>][<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">psie</span><span class="ansi-yellow-fg">'</span>],
<span class="ansi-green-fg">    337</span>                                                                     b_camp=soil_parameters_dict[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">layer_3</span><span class="ansi-yellow-fg">'</span>][<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">b_campbell</span><span class="ansi-yellow-fg">'</span>],)},)
<span class="ansi-green-fg">    339</span>             <span style="font-style:italic;color:rgb(95,135,135)"># Add field capacity --------------------------------------------</span>
<span class="ansi-green-fg">    340</span>             <span style="font-style:italic;color:rgb(95,135,135)">#soil_parameters_dict['field_capacity'] = collections.defaultdict(</span>
<span class="ansi-green-fg">    341</span>             <span style="font-style:italic;color:rgb(95,135,135)">#    list,{</span>
<span class="ansi-green-fg">   (...)</span><span class="ansi-green-fg">    455</span> <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">    456</span>             <span style="font-style:italic;color:rgb(95,135,135)"># f'Option {soil_parameters_dict["pedo_transfer_formulation"]} not recognized.'</span>
<span class="ansi-green-fg">    457</span>             <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">ValueError</span>(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">Failed to create soil parameters from input file</span><span class="ansi-yellow-fg">"</span>)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">~/Documents/projects/modeling/pysureau/pysureau/soil_utils.py:150</span>, in <span class="ansi-cyan-fg">compute_theta_at_given_p_soil_camp</span><span class="ansi-blue-fg">(theta_sat, psi_target, psie, b_camp)</span>
<span class="ansi-green-fg">    140</span> np.testing.assert_array_less(
<span class="ansi-green-fg">    141</span>     np.array(b_camp), <span class="ansi-green-fg">0</span>, err_msg=<span class="ansi-yellow-fg">'</span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span><span class="ansi-yellow-fg">Error: b_camp values must be negative</span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span><span class="ansi-yellow-fg">'</span>
<span class="ansi-green-fg">    142</span> )
<span class="ansi-green-fg">    144</span> np.testing.assert_array_less(
<span class="ansi-green-fg">    145</span>     np.array(psi_target),
<span class="ansi-green-fg">    146</span>     <span class="ansi-green-fg">0</span>,
<span class="ansi-green-fg">    147</span>     err_msg=<span class="ansi-yellow-fg">'</span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span><span class="ansi-yellow-fg">Error: psi_target values must be negative</span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span><span class="ansi-yellow-fg">'</span>,
<span class="ansi-green-fg">    148</span> )
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">150</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> theta_sat * (psi_target / psie) ** (<span class="ansi-green-fg ansi-yellow-bg">1</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">/</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">b_camp</span>)

<span class="ansi-red-fg">TypeError</span>: unsupported operand type(s) for /: 'int' and 'list'</pre>
```
:::

:::
:::



